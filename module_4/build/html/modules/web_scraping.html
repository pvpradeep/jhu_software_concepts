

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Web Scraping &mdash; m4_pytestDoc 25.10 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=3f42e8df"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Data Cleaning" href="data_cleaning.html" />
    <link rel="prev" title="Data Loading and Database Management" href="data_loading.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            m4_pytestDoc
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="data_loading.html">Data Loading and Database Management</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Web Scraping</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#src.scrape._isStartOfNewRecord"><code class="docutils literal notranslate"><span class="pre">_isStartOfNewRecord()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#src.scrape._is_existing_record"><code class="docutils literal notranslate"><span class="pre">_is_existing_record()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#src.scrape._scrape_one_page"><code class="docutils literal notranslate"><span class="pre">_scrape_one_page()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#src.scrape.fetch_html_or_sample"><code class="docutils literal notranslate"><span class="pre">fetch_html_or_sample()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#src.scrape.save_data"><code class="docutils literal notranslate"><span class="pre">save_data()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#src.scrape.scrape_new"><code class="docutils literal notranslate"><span class="pre">scrape_new()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="data_cleaning.html">Data Cleaning</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_query.html">Data Query and Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="web_app.html">Web Application</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">m4_pytestDoc</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Web Scraping</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/modules/web_scraping.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-src.scrape">
<span id="web-scraping"></span><h1>Web Scraping<a class="headerlink" href="#module-src.scrape" title="Link to this heading"></a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="src.scrape._isStartOfNewRecord">
<span class="sig-prename descclassname"><span class="pre">src.scrape.</span></span><span class="sig-name descname"><span class="pre">_isStartOfNewRecord</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">row</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.scrape._isStartOfNewRecord" title="Link to this definition"></a></dt>
<dd><p>Check if a table row represents the start of a new grad record.</p>
<p>This internal function identifies the start of a new record by looking for
a specific div element with certain CSS classes and non-empty text content.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>row</strong> (<em>bs4.element.Tag</em>) – BeautifulSoup row element from the scraped table</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if row is start of new record, False otherwise</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scrape._is_existing_record">
<span class="sig-prename descclassname"><span class="pre">src.scrape.</span></span><span class="sig-name descname"><span class="pre">_is_existing_record</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">record</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latest_records_in_db</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.scrape._is_existing_record" title="Link to this definition"></a></dt>
<dd><p>Check if a scraped record already exists in the database.</p>
<p>Compares the URL of the new record against URLs in the most recent database
records to prevent duplicate entries. URL comparison is used instead of date
due to potential format differences.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>record</strong> (<em>dict</em>) – Newly scraped record to check</p></li>
<li><p><strong>latest_records_in_db</strong> (<em>list</em><em>[</em><em>dict</em><em>]</em>) – Recent records from database for comparison</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if record exists in database, False otherwise</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scrape._scrape_one_page">
<span class="sig-prename descclassname"><span class="pre">src.scrape.</span></span><span class="sig-name descname"><span class="pre">_scrape_one_page</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">page_number</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latest_records_in_db</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.scrape._scrape_one_page" title="Link to this definition"></a></dt>
<dd><p>Scrape a single page of grad records and process the content.</p>
<p>Fetches and parses one page of graduate admissions records, checking each
record against the database to avoid duplicates. Stops when finding an
existing record.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>page_number</strong> (<em>int</em>) – Page number to scrape from GradCafe</p></li>
<li><p><strong>latest_records_in_db</strong> (<em>list</em><em>[</em><em>dict</em><em>]</em>) – Recent records from database for comparison</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if an existing record was found (indicating to stop scraping)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
<dl class="simple">
<dt>Global variables:</dt><dd><ul class="simple">
<li><p>records: List where new records are appended</p></li>
<li><p>surveys: Base URL format string for GradCafe pages</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scrape.fetch_html_or_sample">
<span class="sig-prename descclassname"><span class="pre">src.scrape.</span></span><span class="sig-name descname"><span class="pre">fetch_html_or_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">url</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.scrape.fetch_html_or_sample" title="Link to this definition"></a></dt>
<dd><p>Fetch HTML content from URL or return sample data for testing.</p>
<p>This function either fetches live data from a URL or returns sample data
based on the USE_SAMPLE_HTML environment variable. This allows for
consistent testing without hitting the live website.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>url</strong> (<em>str</em>) – URL to fetch HTML content from</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>HTML content as string</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Exception</strong> – If live URL fetch fails with non-200 status</p>
</dd>
</dl>
<dl class="simple">
<dt>Environment Variables:</dt><dd><p>USE_SAMPLE_HTML: If “1”, uses sample data instead of live fetching</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scrape.save_data">
<span class="sig-prename descclassname"><span class="pre">src.scrape.</span></span><span class="sig-name descname"><span class="pre">save_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">records</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.scrape.save_data" title="Link to this definition"></a></dt>
<dd><p>Save scraped records to a JSON file, appending to existing data if present.</p>
<p>Handles both creating new files and updating existing ones. Preserves any
existing records while adding new ones. Uses UTF-8 encoding and pretty
printing for the JSON output.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>records</strong> (<em>list</em><em>[</em><em>dict</em><em>]</em>) – New records to save</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – Name of the file to save to</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Global variables:</dt><dd><ul class="simple">
<li><p>JSON_DATA_FILEPATH: Directory where JSON files are stored</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.scrape.scrape_new">
<span class="sig-prename descclassname"><span class="pre">src.scrape.</span></span><span class="sig-name descname"><span class="pre">scrape_new</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nPage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_records</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">400</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.scrape.scrape_new" title="Link to this definition"></a></dt>
<dd><p>Main scraping function to collect new graduate admission records.</p>
<p>Scrapes GradCafe pages sequentially until either reaching the maximum
record count or finding an existing record. Includes rate limiting
to be respectful to the server.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nPage</strong> (<em>int</em>) – Starting page number to scrape from, defaults to 1</p></li>
<li><p><strong>max_records</strong> (<em>int</em>) – Maximum number of records to collect, defaults to 400</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Global variables:</dt><dd><ul class="simple">
<li><p>records: List storing scraped records</p></li>
<li><p>applicant_data_file: File where records are saved</p></li>
</ul>
</dd>
<dt>Note:</dt><dd><p>Includes a 0.25 second delay between pages to avoid overwhelming the server</p>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="data_loading.html" class="btn btn-neutral float-left" title="Data Loading and Database Management" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="data_cleaning.html" class="btn btn-neutral float-right" title="Data Cleaning" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, pprasan2.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>